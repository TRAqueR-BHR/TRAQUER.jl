<Bundle xmlns="http://hl7.org/fhir">
  <type value="transaction"/>

  <!-- Organization (hospital) -->
  <entry>
    <fullUrl value="urn:uuid:org-1"/>
    <resource>
      <Organization>
        <id value="org-1"/>
        <name value="Your Hospital"/>
      </Organization>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Organization"/>
    </request>
  </entry>

  <!-- Location: ICU REA1 -->
  <entry>
    <fullUrl value="urn:uuid:loc-rea1"/>
    <resource>
      <Location>
        <id value="loc-rea1"/>
        <identifier>
          <system value="urn:unit-code"/>
          <value value="REA1"/>
        </identifier>
        <name value="Service de réanimation post-opératoire"/>
        <managingOrganization>
          <reference value="urn:uuid:org-1"/>
        </managingOrganization>
      </Location>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Location"/>
    </request>
  </entry>

  <!-- Location: Sector 2 within REA1 -->
  <entry>
    <fullUrl value="urn:uuid:loc-rea1-sector2"/>
    <resource>
      <Location>
        <id value="loc-rea1-sector2"/>
        <identifier>
          <system value="urn:sector-code"/>
          <value value="REA1-S2"/>
        </identifier>
        <name value="Secteur 2"/>
        <managingOrganization>
          <reference value="urn:uuid:org-1"/>
        </managingOrganization>
        <partOf>
          <reference value="urn:uuid:loc-rea1"/>
        </partOf>
      </Location>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Location"/>
    </request>
  </entry>

  <!-- Location: Room 302 in Sector 2 -->
  <entry>
    <fullUrl value="urn:uuid:loc-room302"/>
    <resource>
      <Location>
        <id value="loc-room302"/>
        <identifier>
          <system value="urn:room-code"/>
          <value value="REA1-S2-302"/>
        </identifier>
        <name value="Chambre 302"/>
        <managingOrganization>
          <reference value="urn:uuid:org-1"/>
        </managingOrganization>
        <partOf>
          <reference value="urn:uuid:loc-rea1-sector2"/>
        </partOf>
      </Location>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Location"/>
    </request>
  </entry>

  <!-- Patient P123456 -->
  <entry>
    <fullUrl value="urn:uuid:pat-p123456"/>
    <resource>
      <Patient>
        <id value="pat-p123456"/>
        <identifier>
          <system value="urn:patient-ref"/>
          <value value="P123456"/>
        </identifier>
        <name>
          <family value="Kerouec"/>
          <given value="André"/>
        </name>
        <birthDate value="1980-01-01"/>
        <managingOrganization>
          <reference value="urn:uuid:org-1"/>
        </managingOrganization>
      </Patient>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Patient"/>
    </request>
  </entry>

  <!-- Encounter: overall hospitalization -->
  <entry>
    <fullUrl value="urn:uuid:enc-1"/>
    <resource>
      <Encounter>
        <id value="enc-1"/>
        <status value="finished"/>
        <class>
          <system value="http://terminology.hl7.org/CodeSystem/v3-ActCode"/>
          <code value="IMP"/> <!-- inpatient -->
        </class>
        <subject>
          <reference value="urn:uuid:pat-p123456"/>
        </subject>
        <period>
          <start value="2024-10-01T08:00:00+02:00"/>
          <!-- end omitted if still in hospital; include when known -->
        </period>
        <!-- Location history corresponds to unit movements -->
        <location>
          <location>
            <reference value="urn:uuid:loc-room302"/>
            <display value="Chambre 302, Secteur 2, REA1"/>
          </location>
          <period>
            <start value="2024-10-01T08:00:00+02:00"/>
            <end value="2024-10-03T08:00:00+02:00"/>
          </period>
        </location>
      </Encounter>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Encounter"/>
    </request>
  </entry>

  <!-- ServiceRequest: CPE screening -->
  <entry>
    <fullUrl value="urn:uuid:sr-a123456"/>
    <resource>
      <ServiceRequest>
        <id value="sr-a123456"/>
        <identifier>
          <system value="urn:analysis-ref"/>
          <value value="A123456"/>
        </identifier>
        <status value="completed"/>
        <intent value="order"/>
        <code>
          <!-- TODO: put your real code (e.g., LOINC for CPE screening) -->
          <coding>
            <system value="http://loinc.org"/>
            <code value="XXXXX-X"/>
            <display value="CPE screening, stool/rectal swab"/>
          </coding>
          <text value="bacterial_culture_carbapenemase_producing_enterobacteriaceae"/>
        </code>
        <subject>
          <reference value="urn:uuid:pat-p123456"/>
        </subject>
        <encounter>
          <reference value="urn:uuid:enc-1"/>
        </encounter>
        <authoredOn value="2024-10-01T23:00:00+02:00"/>
        <specimen>
          <reference value="urn:uuid:spec-a123456"/>
        </specimen>
      </ServiceRequest>
    </resource>
    <request>
      <method value="POST"/>
      <url value="ServiceRequest"/>
    </request>
  </entry>

  <!-- Specimen: stool / rectal swab -->
  <entry>
    <fullUrl value="urn:uuid:spec-a123456"/>
    <resource>
      <Specimen>
        <id value="spec-a123456"/>
        <type>
          <!-- Prefer SNOMED: 258608002 = Stool specimen; 119376003 = Rectal swab -->
          <coding>
            <system value="http://snomed.info/sct"/>
            <code value="258608002"/>
            <display value="Stool specimen"/>
          </coding>
          <text value="tissue"/>
        </type>
        <subject>
          <reference value="urn:uuid:pat-p123456"/>
        </subject>
        <receivedTime value="2024-10-01T23:00:00+02:00"/>
      </Specimen>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Specimen"/>
    </request>
  </entry>

  <!-- Observation: CPE result -->
  <entry>
    <fullUrl value="urn:uuid:obs-a123456"/>
    <resource>
      <Observation>
        <id value="obs-a123456"/>
        <basedOn>
          <reference value="urn:uuid:sr-a123456"/>
        </basedOn>
        <status value="final"/>
        <category>
          <coding>
            <system value="http://terminology.hl7.org/CodeSystem/observation-category"/>
            <code value="laboratory"/>
          </coding>
        </category>
        <code>
          <!-- Use the same test code as ServiceRequest -->
          <coding>
            <system value="http://loinc.org"/>
            <code value="XXXXX-X"/>
            <display value="CPE screening"/>
          </coding>
        </code>
        <subject>
          <reference value="urn:uuid:pat-p123456"/>
        </subject>
        <encounter>
          <reference value="urn:uuid:enc-1"/>
        </encounter>
        <effectiveDateTime value="2024-10-02T15:00:00+02:00"/>
        <issued value="2024-10-02T15:00:00+02:00"/>
        <!-- Positive/negative -->
        <valueCodeableConcept>
          <coding>
            <system value="http://terminology.hl7.org/CodeSystem/v2-0078"/>
            <code value="POS"/>
            <display value="Positive"/>
          </coding>
        </valueCodeableConcept>
        <specimen>
          <reference value="urn:uuid:spec-a123456"/>
        </specimen>
        <!-- Organism identified -->
        <component>
          <code>
            <coding>
              <system value="http://loinc.org"/>
              <code value="630-4"/>
              <display value="Bacteria identified in Specimen"/>
            </coding>
          </code>
          <valueCodeableConcept>
            <coding>
              <system value="http://snomed.info/sct"/>
              <code value="6387005"/>
              <display value="Klebsiella pneumoniae"/>
            </coding>
            <text value="Klebsiella pneumoniae"/>
          </valueCodeableConcept>
        </component>
      </Observation>
    </resource>
    <request>
      <method value="POST"/>
      <url value="Observation"/>
    </request>
  </entry>

  <!-- DiagnosticReport: optional grouping -->
  <entry>
    <fullUrl value="urn:uuid:dr-a123456"/>
    <resource>
      <DiagnosticReport>
        <id value="dr-a123456"/>
        <status value="final"/>
        <category>
          <coding>
            <system value="http://terminology.hl7.org/CodeSystem/v2-0074"/>
            <code value="MB"/>
            <display value="Microbiology"/>
          </coding>
        </category>
        <code>
          <text value="CPE screening report"/>
        </code>
        <subject>
          <reference value="urn:uuid:pat-p123456"/>
        </subject>
        <encounter>
          <reference value="urn:uuid:enc-1"/>
        </encounter>
        <effectiveDateTime value="2024-10-02T15:00:00+02:00"/>
        <specimen>
          <reference value="urn:uuid:spec-a123456"/>
        </specimen>
        <result>
          <reference value="urn:uuid:obs-a123456"/>
        </result>
      </DiagnosticReport>
    </resource>
    <request>
      <method value="POST"/>
      <url value="DiagnosticReport"/>
    </request>
  </entry>

</Bundle>
